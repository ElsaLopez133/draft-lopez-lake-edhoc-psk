<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>EDHOC PSK authentication</title>
<meta content="Elsa Lopez Perez" name="author">
<meta content="
       TODO Abstract 
    " name="description">
<meta content="xml2rfc 3.21.0" name="generator">
<meta content="draft-lopez-lake-edhoc-psk-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-lopez-lake-edhoc-psk.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TODO - Abbreviation</td>
<td class="right">June 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Perez</td>
<td class="center">Expires 27 December 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAKE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-lopez-lake-edhoc-psk-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-06-25" class="published">25 June 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-12-27">27 December 2024</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. L. Perez</div>
<div class="org">Inria</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">EDHOC PSK authentication</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">TODO Abstract<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://elsalopez133.github.io/draft-lopez-lake-edhoc-psk/#go.draft-lopez-lake-edhoc-psk.html">https://elsalopez133.github.io/draft-lopez-lake-edhoc-psk/#go.draft-lopez-lake-edhoc-psk.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-lopez-lake-edhoc-psk/">https://datatracker.ietf.org/doc/draft-lopez-lake-edhoc-psk/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        LAKE Working Group mailing list (<span><a href="mailto:lake@ietf.org">mailto:lake@ietf.org</a></span>),
        which is archived at <span><a href="https://example.com/WG">https://example.com/WG</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/lake/">https://www.ietf.org/mailman/listinfo/lake/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ElsaLopez133/draft-lopez-lake-psk">https://github.com/ElsaLopez133/draft-lopez-lake-psk</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 December 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-motivation" class="internal xref">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-assumptions" class="internal xref">Assumptions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol" class="internal xref">Protocol</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-variant-1" class="internal xref">Variant 1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-variant-2" class="internal xref">Variant 2</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-key-derivation" class="internal xref">Key derivation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-variant-1-2" class="internal xref">Variant 1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-variant-2-2" class="internal xref">Variant 2</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-message-formatting-and-proc" class="internal xref">Message formatting and processing. Differences with respect to RFC9528</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-variant-1-3" class="internal xref">Variant 1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-message-1" class="internal xref">Message 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-message-2" class="internal xref">Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-message-3" class="internal xref">Message 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-message-4" class="internal xref">Message 4</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-variant-2-3" class="internal xref">Variant 2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-message-1-2" class="internal xref">Message 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-message-2-2" class="internal xref">Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-message-3-2" class="internal xref">Message 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="auto internal xref">6.2.4</a>.  <a href="#name-message-4-2" class="internal xref">Message 4</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-identity-protection" class="internal xref">Identity protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-number-of-messages" class="internal xref">Number of messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-external-authorization-data" class="internal xref">External Authorization Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-optimization" class="internal xref">Optimization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-mutual-authentication" class="internal xref">Mutual Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-attacks" class="internal xref">Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-comparison" class="internal xref">Comparison</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-unified-approach-and-recomm" class="internal xref">Unified Approach and Recommendations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
        </h3>
<p id="section-1.1-1">Pre-shared key (PSK) authentication method provides a balance between security and computational efficiency.
This authentication method was proposed in the first drafts of Ephemeral Diffie-Hellman Over COSE (EDHOC), and was ruled out to speed out the development process.
However, there is now a renewed effort to reintroduce PSK authentication, making this draft an update to the <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">One prominent use case of PSK authentication in the EDHOC protocol is the update of session keys.
This method aims to reduce the computational cost that comes with re-running the protocol with public authentication keys.
This efficiency is beneficial in scenarios where frequent key updates are needed, such in resource-constrained environments or applications requiring high-frequency secure communications.
The use of PSK authentication in EDHOC ensures that session key can be refreshed without heavy computational overhead, typically associated with public key operations, thus optimizing both performance and security.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The resumption capability in Extensible Authentication Protocol (EAP) leveraging EDHOC can benefit from this method.
EAP-EDHOC resumption aims to provide a streamlined process for re-establishing secure sessions, reducing latency and resource consumption.
By employing PSK authentication for key updates, EAP-EDHOC resumption can achieve  secure session resumption, enhancing overall efficiency and user experience.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">EDHOC with PSK authentication is also beneficial for existing systems where two nodes have been provided with a PSK from other parties.
This allows the nodes to perform ephemeral Diffie-Hellman to achieve Perfect Forward Secrecy (PFS), ensuring that past communications remain secure even if the PSK is compromised.
The authentication provided by EDHOC prevents eavesdropping by on-path attackers, as they would need to be active participants in the communication to intercept and potentially tamper with the session.
Examples could be Generic Bootstrapping Architecture (GBA) and Authenticated Key Management Architecture (AKMA) in mobile systems, or Peer and Authenticator in EAP.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="assumptions">
<section id="section-1.2">
        <h3 id="name-assumptions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-assumptions" class="section-name selfRef">Assumptions</a>
      </h3>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-3">
      <h2 id="name-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
      </h2>
<p id="section-3-1">There are currently two proposed versions of the authentication method, depending on where the pre-shared key identifier (ID_CRED_PSK) is sent.
ID_CRED_PSK allows retrieval of CRED_PSK, a COSE object that contains the PSK.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">In both cases, Initiator and Responder are assumed to have a PSK with good amount of randomness and the requirements that:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <p id="section-3-3.1.1">Only the Initiator and the Responder have access to the PSK.<a href="#section-3-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.2">
          <p id="section-3-3.2.1">The Responder is able to retrieve the PSK using ID_CRED_PSK.<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-4">where:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">
          <p id="section-3-5.1.1">ID_CRED_PSK is a COSE header map containing header parameters that can identify a pre-shared key. For example:<a href="#section-3-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div class="alignLeft art-text artwork" id="section-3-6">
<pre>
ID_CRED_PSK = {4 : h'lf' }
</pre><a href="#section-3-6" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3-7.1">
          <p id="section-3-7.1.1">CRED_PSK is a COSE_Key compatible credential, encoded as a CCS or CWT. For example:<a href="#section-3-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div class="alignLeft art-text artwork" id="section-3-8">
<pre>
{                                               /CCS/
  2 : "mydotbot",                               /sub/
  8 : {                                         /cnf/
    1 : {                                       /COSE_Key/
       1 : 4,                                   /kty/
       2 : h'32',                               /kid/
      -1 : h'50930FF462A77A3540CF546325DEA214'  /k/
    }
  }
}
</pre><a href="#section-3-8" class="pilcrow">¶</a>
</div>
<p id="section-3-9">The purpose of ID_CRED_PSK is to facilitate the retrieval of the PSK.
It is <span class="bcp14">RECOMMENDED</span> that it uniquely identifies the CRED_PSK as the recipient might otherwise have to try several keys.
If ID_CRED_PSK contains a single 'kid' parameter, then the compact encoding is applied; see Section 3.5.3.2 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.
The authentication credential CRED_PSK substitutes CRED_I and CRED_R specified in <span>[<a href="#RFC9529" class="cite xref">RFC9529</a>]</span>, and, when applicable, <span class="bcp14">MUST</span> follow the same guidelines described in Sections 3.5.2 and 3.5.3 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="variant-1">
<section id="section-4">
      <h2 id="name-variant-1">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-variant-1" class="section-name selfRef">Variant 1</a>
      </h2>
<p id="section-4-1">In the first variant of the method the ID_CRED_PSK is sent in the clear in the first message.
<a href="#fig-variant1" class="auto internal xref">Figure 1</a> shows the message flow of Variant 1.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-overview-of-message-flow-of"></span><div id="fig-variant1">
<figure id="figure-1">
        <div id="section-4-2.1">
          <div class="alignCenter art-svg artwork" id="section-4-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="560" viewBox="0 0 560 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,272" fill="none" stroke="black"></path>
              <path d="M 552,48 L 552,272" fill="none" stroke="black"></path>
              <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
              <path d="M 16,128 L 552,128" fill="none" stroke="black"></path>
              <path d="M 8,192 L 544,192" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="552,192 540,186.4 540,197.6" fill="black" transform="rotate(0,544,192)"></polygon>
              <polygon class="arrowhead" points="552,64 540,58.4 540,69.6" fill="black" transform="rotate(0,544,64)"></polygon>
              <polygon class="arrowhead" points="24,128 12,122.4 12,133.6" fill="black" transform="rotate(180,16,128)"></polygon>
              <g class="text">
                <text x="40" y="36">Initiator</text>
                <text x="520" y="36">Responder</text>
                <text x="120" y="52">METHOD,</text>
                <text x="192" y="52">SUITES_I,</text>
                <text x="252" y="52">G_X,</text>
                <text x="292" y="52">C_I,</text>
                <text x="364" y="52">ID_CRED_PSK,</text>
                <text x="440" y="52">EAD_1</text>
                <text x="280" y="84">message_1</text>
                <text x="188" y="116">G_Y,</text>
                <text x="228" y="116">Enc(</text>
                <text x="268" y="116">C_R,</text>
                <text x="316" y="116">MAC_2,</text>
                <text x="368" y="116">EAD_2</text>
                <text x="400" y="116">)</text>
                <text x="280" y="148">message_2</text>
                <text x="248" y="180">AEAD(</text>
                <text x="296" y="180">EAD_3</text>
                <text x="328" y="180">)</text>
                <text x="280" y="212">message_3</text>
                <text x="248" y="244">AEAD(</text>
                <text x="296" y="244">EAD_4</text>
                <text x="328" y="244">)</text>
                <text x="20" y="260">&lt;-</text>
                <text x="40" y="260">-</text>
                <text x="56" y="260">-</text>
                <text x="72" y="260">-</text>
                <text x="88" y="260">-</text>
                <text x="104" y="260">-</text>
                <text x="120" y="260">-</text>
                <text x="136" y="260">-</text>
                <text x="152" y="260">-</text>
                <text x="168" y="260">-</text>
                <text x="184" y="260">-</text>
                <text x="200" y="260">-</text>
                <text x="216" y="260">-</text>
                <text x="232" y="260">-</text>
                <text x="248" y="260">-</text>
                <text x="264" y="260">-</text>
                <text x="280" y="260">-</text>
                <text x="296" y="260">-</text>
                <text x="312" y="260">-</text>
                <text x="328" y="260">-</text>
                <text x="344" y="260">-</text>
                <text x="360" y="260">-</text>
                <text x="376" y="260">-</text>
                <text x="392" y="260">-</text>
                <text x="408" y="260">-</text>
                <text x="424" y="260">-</text>
                <text x="440" y="260">-</text>
                <text x="456" y="260">-</text>
                <text x="472" y="260">-</text>
                <text x="488" y="260">-</text>
                <text x="504" y="260">-</text>
                <text x="520" y="260">-</text>
                <text x="536" y="260">-</text>
                <text x="280" y="276">message_4</text>
              </g>
            </svg><a href="#section-4-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-overview-of-message-flow-of" class="selfRef">Overview of message flow of Variant 1.</a>
        </figcaption></figure>
</div>
<p id="section-4-3">This approach is similar to TLS 1.3, and, consequently, has similar privacy issues. For example:<a href="#section-4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-4.1">
          <p id="section-4-4.1.1"><strong>Identity Leakage</strong>: neither the identity of the Initiator nor the Responder are protected against active or passive attackers.
By sending the ID_CRED_PSK in the clear, the initiator reveals its identity to any eavesdropper on the network.
This allows passive observers to learn which client is attempting to connect to the server.<a href="#section-4-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.2">
          <p id="section-4-4.2.1"><strong>Tracking and correlation</strong>: An attacker can use the plaintext ID_CRED_PSK to track the client across multiple connections, even if those connections are made from different networks or at different times.
This enables long-term tracking of clients.<a href="#section-4-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.3">
          <p id="section-4-4.3.1"><strong>Information leakage about relationships</strong>: ID_CRED_PSK also reveals information about the relationship between the client and the server.
An observer can infer that the two parties have a pre-existing relationship and have previously agreed on a shared secret.<a href="#section-4-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.4">
          <p id="section-4-4.4.1"><strong>Replay and preplay attacks</strong>: ID_CRED_PSK can facilitate replay attacks.
An attacker might use the observed ID_CRED_PSK to initiate their own connection attempts, potentially leading to denial-of-service or other attacks.<a href="#section-4-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-4.5">
          <p id="section-4-4.5.1"><strong>Downgrade attacks</strong>: If multiple PSKs are available (e.g., of varying strengths or for different purposes), an attacker might attempt to force the use of a weaker or less privacy-preserving PSK by manipulating the ID_CRED_PSK field.<a href="#section-4-4.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-5">This variant incurs minimal modifications with respect to the current methods described in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> and the fourth message remains optional.
MAC_3 is removed in message_3 and replaced by AEAD.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="variant-2">
<section id="section-4.1">
        <h3 id="name-variant-2">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-variant-2" class="section-name selfRef">Variant 2</a>
        </h3>
<p id="section-4.1-1">The ID_CRED_PSK is sent in message_3, encrypted using a key derived from the ephemeral shared secret, G_XY.
In this case, the Responder will authenticate the Initiator first, contrary to Variant 1.
<a href="#fig-variant2" class="auto internal xref">Figure 2</a> shows the message flow of Variant 2.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-overview-of-message-flow-of-"></span><div id="fig-variant2">
<figure id="figure-2">
          <div id="section-4.1-2.1">
            <div class="alignCenter art-svg artwork" id="section-4.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="560" viewBox="0 0 560 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,272" fill="none" stroke="black"></path>
                <path d="M 552,48 L 552,272" fill="none" stroke="black"></path>
                <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
                <path d="M 16,128 L 552,128" fill="none" stroke="black"></path>
                <path d="M 8,192 L 544,192" fill="none" stroke="black"></path>
                <path d="M 16,256 L 552,256" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="552,192 540,186.4 540,197.6" fill="black" transform="rotate(0,544,192)"></polygon>
                <polygon class="arrowhead" points="552,64 540,58.4 540,69.6" fill="black" transform="rotate(0,544,64)"></polygon>
                <polygon class="arrowhead" points="24,256 12,250.4 12,261.6" fill="black" transform="rotate(180,16,256)"></polygon>
                <polygon class="arrowhead" points="24,128 12,122.4 12,133.6" fill="black" transform="rotate(180,16,128)"></polygon>
                <g class="text">
                  <text x="40" y="36">Initiator</text>
                  <text x="520" y="36">Responder</text>
                  <text x="184" y="52">METHOD,</text>
                  <text x="256" y="52">SUITES_I,</text>
                  <text x="316" y="52">G_X,</text>
                  <text x="356" y="52">C_I,</text>
                  <text x="400" y="52">EAD_1</text>
                  <text x="280" y="84">message_1</text>
                  <text x="204" y="116">G_Y,</text>
                  <text x="244" y="116">Enc(</text>
                  <text x="284" y="116">C_R,</text>
                  <text x="328" y="116">EAD_2</text>
                  <text x="360" y="116">)</text>
                  <text x="280" y="148">message_2</text>
                  <text x="180" y="180">Enc(</text>
                  <text x="248" y="180">ID_CRED_PSK</text>
                  <text x="308" y="180">),</text>
                  <text x="344" y="180">AEAD(</text>
                  <text x="392" y="180">EAD_3</text>
                  <text x="424" y="180">)</text>
                  <text x="280" y="212">message_3</text>
                  <text x="248" y="244">AEAD(</text>
                  <text x="296" y="244">EAD_4</text>
                  <text x="328" y="244">)</text>
                  <text x="280" y="276">message_4</text>
                </g>
              </svg><a href="#section-4.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-overview-of-message-flow-of-" class="selfRef">Overview of message flow of Variant 2.</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">Contrary to Variant 1, this approach provides protection against passive attackers for both Initiator and Responder.
message_4 remains optional, but is needed to achieve mutual authentication if not relaying on external applications, such as OSCORE.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-derivation">
<section id="section-5">
      <h2 id="name-key-derivation">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-key-derivation" class="section-name selfRef">Key derivation</a>
      </h2>
<p id="section-5-1">The pseudorandom keys (PRKs) used for PSK authentication method in EDHOC are derived using EDHOC_Extract, as done in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-2">
<pre>
PRK  = EDHOC_Extract( salt, IKM )
</pre><a href="#section-5-2" class="pilcrow">¶</a>
</div>
<p id="section-5-3">where the salt and input keying material (IKM) are defined for each key.
The definition of EDHOC_Extract depends on the EDHOC hash algorithm selected in the cipher suite.<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="variant-1-1">
<section id="section-5.1">
        <h3 id="name-variant-1-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-variant-1-2" class="section-name selfRef">Variant 1</a>
        </h3>
<p id="section-5.1-1"><a href="#fig-variant1key" class="auto internal xref">Figure 3</a> lists the key derivations that differ from those specified in Section 4.1.2 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span id="name-key-derivation-of-variant-1"></span><div id="fig-variant1key">
<figure id="figure-3">
          <div class="alignCenter art-text artwork" id="section-5.1-2.1">
<pre>
PRK_3e2m      = EDHOC_Extract( salt3e_2m, CRED_PSK )
PRK_4e3m      = PRK_3e2m
MAC_2         = EDHOC_KDF( PRK_3e2m, 2, context_2, mac_length_2 )
K_3           = EDHOC_KDF( PRK_4e3m,    TBD,  context_3,  key_length )
IV_3          = EDHOC_KDF( PRK_4e3m,    TBD,  context_3,  iv_length  )
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-key-derivation-of-variant-1" class="selfRef">Key derivation of variant 1 of EDHOC PSK authentication method.</a>
          </figcaption></figure>
</div>
<p id="section-5.1-3">where:<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-4.1">
            <p id="section-5.1-4.1.1">context_2 = &lt;&lt;C_R, ID_CRED_PSK, TH_2, CRED_PSK, ? EAD_2&gt;&gt;<a href="#section-5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-4.2">
            <p id="section-5.1-4.2.1">context_3 = &lt;&lt;ID_CRED_PSK, TH_3, CRED_PSK, ? EAD_3&gt;&gt;<a href="#section-5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="variant-2-1">
<section id="section-5.2">
        <h3 id="name-variant-2-2">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-variant-2-2" class="section-name selfRef">Variant 2</a>
        </h3>
<p id="section-5.2-1"><a href="#fig-variant2key" class="auto internal xref">Figure 4</a> lists the key derivations that differ from those specified in Section 4.1.2 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-key-derivation-of-variant-2"></span><div id="fig-variant2key">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-5.2-2.1">
<pre>
PRK_4e3m      = EDHOC_Extract( SALT_4e3m, CRED_PSK )
KEYSTREAM_3   = EDHOC_KDF( PRK_3e2m,    TBD,  TH_3,       key_length )
K_3           = EDHOC_KDF( PRK_4e3m,    TBD,  context_3,  key_length )
IV_3          = EDHOC_KDF( PRK_4e3m,    TBD,  context_3,  iv_length  )
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-key-derivation-of-variant-2" class="selfRef">Key derivation of variant 2 of EDHOC PSK authentication method.</a>
          </figcaption></figure>
</div>
<p id="section-5.2-3">where:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-4.1">
            <p id="section-5.2-4.1.1">KEYSTREAM_3 is used to encrypt the ID_CRED_PSK in message_3.<a href="#section-5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.2">
            <p id="section-5.2-4.2.1">context_3 &lt;&lt;ID_CRED_PSK, TH_3, CRED_PSK, ? EAD_3&gt;&gt;<a href="#section-5.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.3">
            <p id="section-5.2-4.3.1">TH_3 = H( TH_2, PLAINTEXT_2)<a href="#section-5.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.4">
            <p id="section-5.2-4.4.1">TH_4 = H( TH_3, ID_CRED_PSK, ? EAD_3, CRED_PSK )<a href="#section-5.2-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="message-formatting-and-processing-differences-with-respect-to-rfc9528">
<section id="section-6">
      <h2 id="name-message-formatting-and-proc">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-message-formatting-and-proc" class="section-name selfRef">Message formatting and processing. Differences with respect to <span class="cite xref">[RFC9528]</span></a>
      </h2>
<p id="section-6-1">This section specifies the differences on the message formatting compared to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="variant-1-2">
<section id="section-6.1">
        <h3 id="name-variant-1-3">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-variant-1-3" class="section-name selfRef">Variant 1</a>
        </h3>
<div id="message-1">
<section id="section-6.1.1">
          <h4 id="name-message-1">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-message-1" class="section-name selfRef">Message 1</a>
          </h4>
<p id="section-6.1.1-1">message_1 contains the ID_CRED_PSK.
The composition of message_1 <span class="bcp14">SHALL</span> be a CBOR sequence, as defined below:<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.1-2">
<pre>
message_1 = (
  METHOD : int,
  SUITES_I : suites,
  G_X : bstr,
  C_I : bstr / -24..23,
  ID_CRED_PSK : header map // kid_value : bstr,
  ? EAD_1,
)

suites =  [ 2* int ] / int
EAD_1 = 1* ead
</pre><a href="#section-6.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.1-3">where:<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-4.1">
              <p id="section-6.1.1-4.1.1">ID_CRED_PSK is an identifier used to facilitate retrieval of the PSK.<a href="#section-6.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.1-5">The Initiator includes ID_CRED_PSK in message_1 and encodes the full message as a sequence of CBOR-encoded data items as specified in Section 5.2.1. of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span><a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1.1-6">The Responder <span class="bcp14">SHALL</span> process message_1 as follows:<a href="#section-6.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-7.1">
              <p id="section-6.1.1-7.1.1">Decode message_1.<a href="#section-6.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-7.2">
              <p id="section-6.1.1-7.2.1">Retrieve CRED_PSK using ID_CRED_PSK.<a href="#section-6.1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.1-7.3">
              <p id="section-6.1.1-7.3.1">Process message_1 as specified in Section 5.2.3. of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6.1.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="message-2">
<section id="section-6.1.2">
          <h4 id="name-message-2">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-message-2" class="section-name selfRef">Message 2</a>
          </h4>
<p id="section-6.1.2-1">message_2 <span class="bcp14">SHALL</span> be a CBOR sequence, defined as:<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.2-2">
<pre>
message_2 = (
  G_Y_CIPHERTEXT_2 : bstr,
)
</pre><a href="#section-6.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.2-3">where:<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-4.1">
              <p id="section-6.1.2-4.1.1">G_Y_CIPHERTEXT_2 is the concatenation of G_Y (i.e., the ephemeral public key of the Responder) and CIPHERTEXT_2.<a href="#section-6.1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.2-4.2">
              <p id="section-6.1.2-4.2.1">CIPHERTEXT_2 is calculated with a binary additive stream cipher, using KEYSTREAM_2 and the following plaintext:<a href="#section-6.1.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-4.2.2.1">
                  <p id="section-6.1.2-4.2.2.1.1">PLAINTEXT_2 = (C_R, / bstr / -24..23, MAC_2, ? EAD_2)<a href="#section-6.1.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.1.2-4.2.2.2">
                  <p id="section-6.1.2-4.2.2.2.1">CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2<a href="#section-6.1.2-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.1.2-5">The Responder uses MAC instead of Signature. Hence, COSE_Sign1 is not used.
The Responder computes MAC_2 as described in Section 4.1.2 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with context_2 &lt;&lt;C_R, ID_CRED_PSK, TH_2, CRED_PSK, ? EAD_2&gt;&gt;<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-3">
<section id="section-6.1.3">
          <h4 id="name-message-3">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-message-3" class="section-name selfRef">Message 3</a>
          </h4>
<p id="section-6.1.3-1">message_3 <span class="bcp14">SHALL</span> be a CBOR sequence, defined as:<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.3-2">
<pre>
message_3 = (
  CIPHERTEXT_3 : bstr,
)
</pre><a href="#section-6.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.3-3">The Initiator computes a COSE_Encrypt0 object as defined in Section 5.2 and 5.3 of <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> with the EDHOC AEAD algorithm of the selected cipher suite and the following parameters:<a href="#section-6.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.3-4.1">
              <p id="section-6.1.3-4.1.1">K_3 and IV_3 as defined in Section 4.1.2 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span><a href="#section-6.1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.1.3-4.2">
              <p id="section-6.1.3-4.2.1">PLAINTEXT_3 = ( ID_CRED_PSK / bstr / -24..2, ? EAD_3 )<a href="#section-6.1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.1.3-5">The Initiator computes TH_4 = H( TH_3, ID_CRED_PSK, PLAINTEXT_3, CRED_PSK )<a href="#section-6.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-4">
<section id="section-6.1.4">
          <h4 id="name-message-4">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-message-4" class="section-name selfRef">Message 4</a>
          </h4>
<p id="section-6.1.4-1">message_4 <span class="bcp14">SHALL</span> be a CBOR sequence, defined as:<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1.4-2">
<pre>
message_4 = (
  CIPHERTEXT_4 : bstr,
)
</pre><a href="#section-6.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1.4-3">message_4 is optional.<a href="#section-6.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="variant-2-2">
<section id="section-6.2">
        <h3 id="name-variant-2-3">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-variant-2-3" class="section-name selfRef">Variant 2</a>
        </h3>
<div id="message-1-1">
<section id="section-6.2.1">
          <h4 id="name-message-1-2">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-message-1-2" class="section-name selfRef">Message 1</a>
          </h4>
<p id="section-6.2.1-1">Same as message_1 of EDHOC, described in Section 5.2.1 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-2-1">
<section id="section-6.2.2">
          <h4 id="name-message-2-2">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-message-2-2" class="section-name selfRef">Message 2</a>
          </h4>
<p id="section-6.2.2-1">message_2 <span class="bcp14">SHALL</span> be a CBOR sequence, defined as:<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-2">
<pre>
message_2 = (
  G_Y_CIPHERTEXT_2 : bstr,
)
</pre><a href="#section-6.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-3">where:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-4.1">
              <p id="section-6.2.2-4.1.1">G_Y_CIPHERTEXT_2 is the concatenation of G_Y (i.e., the ephemeral public key of the Responder) and CIPHERTEXT_2.<a href="#section-6.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.2-4.2">
              <p id="section-6.2.2-4.2.1">CIPHERTEXT_2 is calculated with a binary additive stream cipher, using KEYSTREAM_2 and the following plaintext:<a href="#section-6.2.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.2-4.2.2.1">
                  <p id="section-6.2.2-4.2.2.1.1">PLAINTEXT_2 = ( C_R, / bstr / -24..23, ? EAD_2 )<a href="#section-6.2.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.2.2-4.2.2.2">
                  <p id="section-6.2.2-4.2.2.2.1">CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2<a href="#section-6.2.2-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.2.2-5">Contrary to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> and Variant 1, MAC_2 is not needed.<a href="#section-6.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-3-1">
<section id="section-6.2.3">
          <h4 id="name-message-3-2">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-message-3-2" class="section-name selfRef">Message 3</a>
          </h4>
<p id="section-6.2.3-1">message_3 <span class="bcp14">SHALL</span> be a CBOR Sequence, as defined below:<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-2">
<pre>
message_3 = (
  CIPHERTEXT_3
)
</pre><a href="#section-6.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3-3">where:<a href="#section-6.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-4.1">
              <p id="section-6.2.3-4.1.1">CIPHERTEXT_3 is a concatenation of two different ciphertexts:<a href="#section-6.2.3-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-4.1.2.1">
                  <p id="section-6.2.3-4.1.2.1.1">CIPHERTEXT_3A is calculated with a binary additive stream cipher, using a KESYSTREAM_3 generated with EDHOC_Expand and the following plaintext:<a href="#section-6.2.3-4.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-4.1.2.1.2.1">
                      <p id="section-6.2.3-4.1.2.1.2.1.1">PLAINTEXT_3A = ( ID_CRED_PSK )<a href="#section-6.2.3-4.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-6.2.3-4.1.2.2">
                  <p id="section-6.2.3-4.1.2.2.1">CIPHERTEXT_3B is a COSE_Encrypt0 object as defined in Sections 5.2 and 5.3 of <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>, with the EDHOC AEAD algorithm of the selected cipher suite, using the encryption key K_3, the initialization vector IV_3 (if used by the AEAD algorithm), the parameters described in Section 5.2 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, plaintext PLAINTEXT_3B and the following parameters as input:<a href="#section-6.2.3-4.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-4.1.2.2.2.1">
                      <p id="section-6.2.3-4.1.2.2.2.1.1">protected = h''<a href="#section-6.2.3-4.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-6.2.3-4.1.2.2.2.2">
                      <p id="section-6.2.3-4.1.2.2.2.2.1">external_aad = context_3, defined in Section 5.2<a href="#section-6.2.3-4.1.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-6.2.3-4.1.2.2.2.3">
                      <p id="section-6.2.3-4.1.2.2.2.3.1">K_3 and IV_3 are defined in Section 5.2<a href="#section-6.2.3-4.1.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-6.2.3-4.1.2.2.2.4">
                      <p id="section-6.2.3-4.1.2.2.2.4.1">PLAINTEXT_3B = ( ? EAD_3 )<a href="#section-6.2.3-4.1.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<p id="section-6.2.3-5">The Initiator computes TH_4 = H( TH_3, ID_CRED_PSK, PLAINTEXT_3, CRED_PSK ), defined in Section 5.2.<a href="#section-6.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-4-1">
<section id="section-6.2.4">
          <h4 id="name-message-4-2">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-message-4-2" class="section-name selfRef">Message 4</a>
          </h4>
<p id="section-6.2.4-1">message_4 <span class="bcp14">SHALL</span> be a CBOR sequence, defined as:<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.4-2">
<pre>
message_4 = (
  CIPHERTEXT_4 : bstr,
)
</pre><a href="#section-6.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.4-3">A fourth message is mandatory.
The Initiator <span class="bcp14">MUST NOT</span> persistently store PRK_out or application keys until the Initiator has verified message_4 or a message protected with a derived application key, such as an OSCORE message, from the Responder and the application has authenticated the Responder.<a href="#section-6.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">When evaluating the security considerations, it is important to differentiate between the initial handshake and session resumption phases.<a href="#section-7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-2">
<li id="section-7-2.1">
          <p id="section-7-2.1.1"><strong>Initial Handshake</strong>: a fresh CRED_PSK is used to establish a secure connection.<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-7-2.2">
          <p id="section-7-2.2.1"><strong>Session Resumption</strong>: the same PSK identifier (ID_CRED_PSK) is reused each time EDHOC is executed.
    While this reuses enhances efficiency and reduces the overhead of key exchanges, it presents privacy risks if not managed properly.
    Over multiple resumption sessions, initiating a full EDHOC session changes the resumption PSK, resulting in a new ID_CRED_PSK.
    The periodic renewal of the CRED_PSK and ID_CRED_PSK helps mitigate long-term privacy risks associated with static key identifiers.<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="identity-protection">
<section id="section-7.1">
        <h3 id="name-identity-protection">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-identity-protection" class="section-name selfRef">Identity protection</a>
        </h3>
<p id="section-7.1-1">The current EDHOC methods protect the Initiator’s identity against active attackers and the Responder’s identity against passive attackers.
However, there are differences between the two variants described in this draft:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.1-2">
<li id="section-7.1-2.1">
            <p id="section-7.1-2.1.1"><strong>Variant 1</strong>: neither the Initiator's identity nor the Responder's identity are protected against active or passive attackers.<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.1-2.2">
            <p id="section-7.1-2.2.1"><strong>Variant 2</strong>: bot the Initiator's and Responder's identities are protected against passive attackers.<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="number-of-messages">
<section id="section-7.2">
        <h3 id="name-number-of-messages">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-number-of-messages" class="section-name selfRef">Number of messages</a>
        </h3>
<p id="section-7.2-1">The current EDHOC protocol consists of three mandatory messages and an optional fourth message.
The PSK authentication method might require a compulsory message depending on which variant is employed:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-2">
<li id="section-7.2-2.1">
            <p id="section-7.2-2.1.1"><strong>Variant 1</strong>: message_4 is optional since both identities are authenticated after message_3.<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.2">
            <p id="section-7.2-2.2.1"><strong>Variant 2</strong>: message_4 remains optional, but mutual authentication is not guaranteed without it, or an OSCORE message.<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="external-authorization-data">
<section id="section-7.3">
        <h3 id="name-external-authorization-data">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-external-authorization-data" class="section-name selfRef">External Authorization Data</a>
        </h3>
<p id="section-7.3-1">In both variants, the Initiator and Responder can send information in EAD_3 and EAD_4 or in OSCORE messages in parallel with message_3 and message_4.
This is possible because the Initiator knows that only the entity with access to the CRED_PSK can decrypt the information.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="optimization">
<section id="section-7.4">
        <h3 id="name-optimization">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-optimization" class="section-name selfRef">Optimization</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-7.4-1">
<li id="section-7.4-1.1">
            <p id="section-7.4-1.1.1"><strong>Variant 1</strong>: ID_CRED_PSK is sent without encryption, saving computational resources at the cost of privacy. In addition, the exposure of ID_CRED_PSK in message_1 allows for earlier key derivation on the responder's side, potentially speeding up the process.<a href="#section-7.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.4-1.2">
            <p id="section-7.4-1.2.1"><strong>Variant 2</strong>: Requires encryption of ID_CRED_PSK in message_3, which implies higher computational cost.<a href="#section-7.4-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="mutual-authentication">
<section id="section-7.5">
        <h3 id="name-mutual-authentication">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-mutual-authentication" class="section-name selfRef">Mutual Authentication</a>
        </h3>
<p id="section-7.5-1">Mutual authentication is achieved at earlier stages in Variant 1, which might be important in certain applications, as well as increasing security against attacks such as DoS or oracle attacks.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attacks">
<section id="section-7.6">
        <h3 id="name-attacks">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-attacks" class="section-name selfRef">Attacks</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-7.6-1">
<li id="section-7.6-1.1">
            <p id="section-7.6-1.1.1"><strong>Variant 1</strong>: It is more vulnerable to passive monitoring and traffic analysis due to the exposed ID_CRED_PSK.<a href="#section-7.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.6-1.2">
            <p id="section-7.6-1.2.1"><strong>Variant 2</strong>:<a href="#section-7.6-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="comparison">
<section id="section-7.7">
        <h3 id="name-comparison">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-comparison" class="section-name selfRef">Comparison</a>
        </h3>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Aspect</th>
              <th class="text-left" rowspan="1" colspan="1">Variant 1 (Clear ID_CRED_PSK)</th>
              <th class="text-left" rowspan="1" colspan="1">Variant 2 (Encrypted ID_CRED_PSK)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Privacy</td>
              <td class="text-left" rowspan="1" colspan="1">Lower: ID_CRED_PSK sent in clear in message_1</td>
              <td class="text-left" rowspan="1" colspan="1">Higher: ID_CRED_PSK encrypted in message_3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Initiator Identity Protection</td>
              <td class="text-left" rowspan="1" colspan="1">Exposed from message_1</td>
              <td class="text-left" rowspan="1" colspan="1">Protected until message_3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Authentication Timing</td>
              <td class="text-left" rowspan="1" colspan="1">Earlier, possible from message_1</td>
              <td class="text-left" rowspan="1" colspan="1">Delayed until message_3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Computational Efficiency</td>
              <td class="text-left" rowspan="1" colspan="1">Slightly higher (no encryption of ID_CRED_PSK)</td>
              <td class="text-left" rowspan="1" colspan="1">Slightly lower (encryption of ID_CRED_PSK)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Resistance to Passive Attacks</td>
              <td class="text-left" rowspan="1" colspan="1">Lower due to exposed identity</td>
              <td class="text-left" rowspan="1" colspan="1">Higher due to identity protection</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Early Access Control</td>
              <td class="text-left" rowspan="1" colspan="1">Possible from message_1</td>
              <td class="text-left" rowspan="1" colspan="1">Limited, delayed until message_3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">DoS Attack Vulnerability</td>
              <td class="text-left" rowspan="1" colspan="1">Lower due to early authentication</td>
              <td class="text-left" rowspan="1" colspan="1">Potentially higher due to delayed authentication</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Resource Allocation</td>
              <td class="text-left" rowspan="1" colspan="1">Fewer resources allocated before authentication</td>
              <td class="text-left" rowspan="1" colspan="1">More resources allocated before authentication</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Compatibility with Systems Expecting Early ID</td>
              <td class="text-left" rowspan="1" colspan="1">Higher</td>
              <td class="text-left" rowspan="1" colspan="1">Lower</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Flexibility for Identity Protection</td>
              <td class="text-left" rowspan="1" colspan="1">Lower</td>
              <td class="text-left" rowspan="1" colspan="1">Higher</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Key Derivation Timing</td>
              <td class="text-left" rowspan="1" colspan="1">Potentially earlier</td>
              <td class="text-left" rowspan="1" colspan="1">Potentially delayed</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Message Structure</td>
              <td class="text-left" rowspan="1" colspan="1">ID_CRED_PSK in message_1, MAC_2 in encrypted part of message_2</td>
              <td class="text-left" rowspan="1" colspan="1">ID_CRED_PSK in message_3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Completeness</td>
              <td class="text-left" rowspan="1" colspan="1">Complete with optional message_4</td>
              <td class="text-left" rowspan="1" colspan="1">Complete with optional message_4</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Suitability for Quick Identification Scenarios</td>
              <td class="text-left" rowspan="1" colspan="1">Higher</td>
              <td class="text-left" rowspan="1" colspan="1">Lower</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
    </h2>
</section>
</div>
<div id="unified-approach-and-recommendations">
<section id="section-9">
      <h2 id="name-unified-approach-and-recomm">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-unified-approach-and-recomm" class="section-name selfRef">Unified Approach and Recommendations</a>
      </h2>
<p id="section-9-1">To improve privacy during both initial handshake and session resumption, a single unified method for handling PSKs could be beneficial.
Variant 2 is particularly suitable for this purpose as it streamlines key management and usage across different phases.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">For use cases involving the transmission of application data, application data can be sent concurrently with message_3, maintaining the protocol's efficiency.
In scenarios such as EAP-EDHOC, where application data is not sent, message_4 is mandatory.
Other implementations may continue using OSCORE in place of EDHOC message_4, with a required change in the protocol's language to:
      The Initiator <span class="bcp14">SHALL NOT</span> persistently store PRK_out or application keys until the Initiator has verified message_4 or a message protected with a derived application key, such as an OSCORE message.
This change ensures that key materials are only stored once their integrity and authenticity are confirmed, thereby enhancing privacy by preventing early storage of potentially compromised keys.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Lastly, whether the Initiator or Responder authenticates first is not relevant when using symmetric keys.
This consideration was important for the privacy properties when using asymmetric authentication but is not significant in the context of symmetric key usage.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has no IANA actions.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9529">[RFC9529]</dt>
    <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, <span class="refAuthor">Serafin, M.</span>, <span class="refAuthor">Tiloca, M.</span>, and <span class="refAuthor">M. Vučinić</span>, <span class="refTitle">"Traces of Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9529</span>, <span class="seriesInfo">DOI 10.17487/RFC9529</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9529">https://www.rfc-editor.org/rfc/rfc9529</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Elsa Lopez Perez</span></div>
<div dir="auto" class="left"><span class="org">Inria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:elsa.lopez-perez@inria.fr" class="email">elsa.lopez-perez@inria.fr</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
